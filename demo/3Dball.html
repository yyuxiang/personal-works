<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>3D自由旋转</title>
		<link rel="stylesheet" href="css/3dball.css"/>
	</head>
	<body>
		<input type="button" value="旋转" class="btn"></input>
		<input type="button" value="圆柱" class="cy"></input>
		<input type="button" value="球" class="ball"></input>
		<input type="button" value="立方体" class="cube"></input>
		<div class="container"></div>
	</body>
</html>
<script>
	window.onload=function(){
		var oContainer = document.querySelector('.container');
		var oBtn = document.querySelector('.btn');
		var oCy = document.querySelector('.cy');
		var oBall = document.querySelector('.ball');
		var oCube = document.querySelector('.cube');
		var oStop = document.querySelector('.stop');
		var str='志向是天才的幼苗经过热爱劳动的双手培育在肥田沃土里将成长为粗壮大树不热爱劳动不进行自我教育志向这棵幼苗也会连根枯死确定个人志向选好专业是幸福的源泉';
		var Deg = 0;
		var timer = null;
		var bsin = false;
		for(var i = 0; i < 73; i++) {
			var oDiv = document.createElement('div');
			oDiv.classList.add('block');
			oDiv.innerHTML=str.charAt(i);
			oContainer.appendChild(oDiv);
		}
		var aBlock = document.querySelectorAll('.block');

		cy();

		oCy.onclick = function() {
			cy();
		}

		function cy() {
			aBlock.forEach(function(oBlock, index) {

				oBlock.style.transition = `0.3s ${index*0.05}s`
				oBlock.style.transform = `rotateY(${index*36}deg) translateZ(100px) translateY(${(index+0.2)*7-200}px)`;
			})
		}
		oBall.onclick = function() {
			bsin = false;
			judge();
			aBlock.forEach(function(oBlock, index) {
				var rotateX = 0;
				var rotateY = 0;

				if(index < 17) {
					rotateY = index * 360 / 17;

				} else if(index < 45) {
					rotateY = (index - 17) % 14 * 360 / 14;
					rotateX = 90 / 4 * ((index - 17) / 14 >= 1 ? 1 : -1);

				} else if(index < 63) {
					rotateY = (index - 45) % 9 * 360 / 9;
					rotateX = 90 / 4 * 2 * ((index - 45) / 9 >= 1 ? 1 : -1);

				} else {
					rotateY = (index - 63) % 5 * 360 / 5;
					rotateX = 90 / 4 * 3 * ((index - 63) / 5 >= 1 ? 1 : -1);
				}

				oBlock.style.transition = `1s ${index}`;
				oBlock.style.transform = `rotateY(${rotateY}deg) rotateX(${rotateX}deg) translateZ(200px)`

			})
		}
		oCube.onclick = function() {
			bsin = true;
			judge();
			aBlock.forEach(function(oBlock, index) {

				oBlock.style.transition = `0.3s`

				var level = parseInt(index / 16);
				var row = parseInt(index % 16 / 4);
				var col = parseInt(index % 16 % 4);

				oBlock.style.transform = `translateX(${((col+1)-2.5)*52}px) translateY(${((row+1)-2.5)*64}px) translateZ(${(2.5-(level+1))*100}px)`;
			})
		}
		oBtn.onclick = function() {
			clearInterval(timer);
			oContainer.style.transition = '1s';
			timer = setInterval(function() {
				Deg++;
				oContainer.style.transform = `rotateY(${Deg}deg)`;
			}, 16);
		}

		function judge() {
			if(bsin) {
				for(var i = 64; i < 73; i++) {
					aBlock[i].style.display = 'none';
				}
			}else{
				for(var i = 64; i < 73; i++) {
					aBlock[i].style.display = 'block';
				}
			}
		}
	};
</script>